package fr.zayzx.zayzlibs.utils;

import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.potion.Potion;
import net.minecraft.potion.PotionEffect;
import net.minecraft.util.Vec3;

public class PlayerAction {

    // Ajoute un item au joueur
    public static void addItem(EntityPlayer player, Item item, int count) {
        if (player == null || item == null) return;
        ItemStack stack = new ItemStack(item, count);
        if (!player.inventory.addItemStackToInventory(stack)) {
            // Si l'inventaire est plein, drop l'item dans le monde
            player.dropPlayerItemWithRandomChoice(stack, false);
        }
    }

    // Retire un item du joueur
    public static void removeItem(EntityPlayer player, Item item, int count) {
        if (player == null || item == null) return;
        for (int i = 0; i < player.inventory.getSizeInventory(); i++) {
            ItemStack stack = player.inventory.getStackInSlot(i);
            if (stack != null && stack.getItem() == item) {
                if (stack.stackSize > count) {
                    stack.stackSize -= count;
                    break;
                } else {
                    count -= stack.stackSize;
                    player.inventory.setInventorySlotContents(i, null);
                    if (count <= 0) break;
                }
            }
        }
    }

    // Applique une force / vecteur au joueur
    public static void applyVelocity(EntityPlayer player, double x, double y, double z) {
        if (player == null) return;
        player.motionX += x;
        player.motionY += y;
        player.motionZ += z;
        player.fallDistance = 0; // Évite les dégâts de chute
    }

    // Applique un effet de potion
    public static void addPotionEffect(EntityPlayer player, Potion potion, int duration, int amplifier) {
        if (player == null || potion == null) return;
        player.addPotionEffect(new PotionEffect(potion.id, duration, amplifier));
    }

    // Retire un effet de potion
    public static void removePotionEffect(EntityPlayer player, Potion potion) {
        if (player == null || potion == null) return;
        player.removePotionEffect(potion.id);
    }

    // Téléporte le joueur
    public static void teleport(EntityPlayer player, double x, double y, double z) {
        if (player == null) return;
        player.setPositionAndUpdate(x, y, z);
    }

    // Fait sauter le joueur
    public static void jump(EntityPlayer player, float strength) {
        if (player == null) return;
        player.motionY = strength;
        player.isAirBorne = true;
    }

    // Applique un vecteur avec direction du regard
    public static void launchForward(EntityPlayer player, double speed) {
        if (player == null) return;
        Vec3 look = player.getLookVec();
        player.motionX += look.xCoord * speed;
        player.motionY += look.yCoord * speed;
        player.motionZ += look.zCoord * speed;
    }

    // Vide l'inventaire du joueur
    public static void clearInventory(EntityPlayer player) {
        if (player == null) return;
        player.inventory.clearInventory(null, -1);
    }
}
